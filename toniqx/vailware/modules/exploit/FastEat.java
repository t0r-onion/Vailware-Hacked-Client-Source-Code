package toniqx.vailware.modules.exploit;

import org.lwjgl.input.Keyboard;

import com.mojang.realmsclient.gui.ChatFormatting;

import net.minecraft.item.Item;
import net.minecraft.item.ItemBow;
import net.minecraft.item.ItemFood;
import net.minecraft.item.ItemSword;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;
import toniqx.vailware.main.event.Event;
import toniqx.vailware.main.event.listeners.EventUpdate;
import toniqx.vailware.main.settings.impl.ModeSetting;
import toniqx.vailware.main.settings.impl.NumberSetting;
import toniqx.vailware.modules.Module;

public class FastEat extends Module {
	
	public ModeSetting mode = new ModeSetting("Mode", "Vanilla", "Vanilla", "Packet", "Redesky");
	public static NumberSetting delay = new NumberSetting("Ticks", 6, 1, 20, 1);
	
	public FastEat(){
		super("FastEat", "", Keyboard.KEY_NONE, Category.EXPLOIT);
		this.addSettings(mode, delay);
	}
	public void onEvent(Event event) {
		if (event instanceof EventUpdate) {
			EventUpdate em = (EventUpdate) event;
			if (em.isPre()) {
				String str = mode.getMode();
				switch (str) {
					case "Timer": {
						if(mc.thePlayer.getItemInUseDuration() >= (delay.getValue()) && canUseItem(mc.thePlayer.getItemInUse().getItem())) {
							mc.timer.timerSpeed = 1.3555f;
						} else if (mc.timer.timerSpeed == 1.3555f) {
							mc.timer.timerSpeed = 1;
						}
						break;
					}
					case "Packet": {
						if (mc.thePlayer.getItemInUseDuration() == (delay.getValue()) && canUseItem(mc.thePlayer.getItemInUse().getItem())) {
							for (int i = 0; i < 30; i++) {
								mc.thePlayer.sendQueue.addToSendQueue(new C03PacketPlayer(true));
							}
							mc.getNetHandler().getNetworkManager().sendPacketNoEvent(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, EnumFacing.DOWN));
							mc.thePlayer.stopUsingItem();
						}
						break;
					}
					case "Redesky": {
		                if(mc.thePlayer.getHeldItem() != null && mc.gameSettings.keyBindUseItem.pressed && mc.thePlayer.getHeldItem().getItem() instanceof ItemFood && (mc.thePlayer.onGround) && mc.thePlayer.ticksExisted % 3 == 0) {

		                    for (int i = 0; i < 5; ++i) {
		                        mc.thePlayer.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(mc.thePlayer.posX, mc.thePlayer.posY, mc.thePlayer.posZ, mc.thePlayer.rotationYaw, mc.thePlayer.rotationPitch, true));
		                    }

		                }
		            }
				}
			}
		}
	}

	private boolean canUseItem(Item item) {
		boolean result = !((item instanceof ItemSword) || (item instanceof ItemBow));
		return result;
	}
}
	